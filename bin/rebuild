#!/usr/bin/env bash
# http://redsymbol.net/articles/unofficial-bash-strict-mode/
set -euo pipefail
IFS=$'\n\t'

sudo echo # make sure password prompt won't pop up later, be perhaps hard to detect
# set -e
intershop_paths_app=$(pwd)
# home=$(realpath "$(readlink -f "$0" | xargs dirname)"/..)
home="$(realpath "$(realpath "${BASH_SOURCE[0]}" | xargs dirname)"/..)"
cd "$home"

#-----------------------------------------------------------------------------------------------------------
source bin/_prepare-environment
bin/_restart-rpc-server

#-----------------------------------------------------------------------------------------------------------
sudo_postgres_unpaged -f db/teardown.sql 2>&1 | grep -P '^.*ERROR.*$|' --color=always
postgres_unpaged      -f db/000-main.sql 2>&1 | grep -P '^.*ERROR.*$|' --color=always



